<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
  <head th:replace="fragments/admin :: head"></head>
  <body>
  <header class="p-3 text-bg-dark" th:replace="fragments/admin :: header">
  </header>
  <div class="row min-vh-100">
  <div class="p-2 text-bg-dark col-2"  th:replace="fragments/admin :: sidebar" >
  </div>
  <script>
  $(document).ready(function() {
	    $('input[type="checkbox"].form-check-input').on('change', function() {
	        var noticeYn = $(this).prop('checked') ? 'Y' : 'N';  // 체크 상태에 따라 'Y' 또는 'N'
	        var id =  $(this).attr('id');  // data-id 속성에서 notice.id 가져오기
	
	        $.ajax({
	            url: '/admin/update/openState',  // 업데이트할 URL
	            method: 'POST',
	            data: {
	                id: id,
	                noticeYn: noticeYn,
	                type : "notice"
	            },
	            success: function(response) {
	                console.log("Notice updated successfully.");
	            },
	            error: function(error) {
	                console.error("Error updating notice:", error);
	            }
	        });
	    });
	});
  </script>
  <div class="container col-9">
		<div class="location">
			<span><a href="/admin/main">관리자 메인</a></span><img th:src="@{/img/location_arrow.gif}">
			<span><a href="/admin/main">공지사항 리스트</a></span><img th:src="@{/img/location_arrow.gif}">
			<span>공지 리스트</span>
		</div>
		<h1>공지사항</h1>
		<button type="button" class="btn btn-outline-secondary btn-lg mt25" onclick="location.href='/admin/notice'">공지작성</button>		
		<div class="row clearboth mt50">
			<div class="col-lg-12 col-md-12 col-sm-12">
				<table cellspacing="0" border="0" class="board">
					<caption>예약문의</caption>
					<tr>
						<th>번호</th>
						<th>제목</th>
						<th>구분</th>
						<th>작성자</th>
						<th>공개</th>
		
					</tr>
					<tr  th:each=" notice : ${notices}">
						<td th:text="${notice.id}"></td>
			
						<td>
		      				<a th:href="@{|/admin/notice/detail/${notice.id}|}"  th:text="${notice.title}" class="text-decoration-none text-dark">제목</a>
						</td>
						<td th:text="${notice.division}"></td>
				        <td th:text="${notice.writer}">작성인</td>
					    <td>
					    	   <!-- 부트스트랩 토글 스위치 -->
						  <div class="form-check form-switch">
							  <input class="form-check-input" 
							  type="checkbox" 
							  th:id="${notice.id}" 
							  th:checked="${notice.noticeYn == 'Y'}" >
						  </div>
						</td>						
					</tr>
				</table>
			</div>
		</div>
		<!-- paging -->
		 <th:block layout:fragment="paging">
			<nav th:replace="fragments/common :: pagination"></nav>
		</th:block> 
		<!-- paging //-->
	</div><!-- // container -->
 </div>
 <!-- ======================
	 * //content *
========================== -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
 
</body>
</html>