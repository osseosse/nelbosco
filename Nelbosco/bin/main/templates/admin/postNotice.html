<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.css" rel="stylesheet">
    <style>
	  .note-editor {
	    border: 1px solid #ced4da !important;
	    border-radius: 0.375rem !important;
	  }
	  .note-btn {
	    font-size: 0.875rem !important;
	  }
	</style>
  </head>
  <body>
    <header class="p-3 text-bg-dark">
      <div class="">
        <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">
          <a href="/" class="d-flex align-items-center mb-2 mb-lg-0 text-white text-decoration-none">
            <svg class="bi me-2" width="40" height="32" role="img" aria-label="Bootstrap"><use xlink:href="#bootstrap"></use></svg>
          </a>

          <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0">
            <li><a href="#" class="nav-link px-2 text-secondary">Home</a></li>
            <li><a href="#" class="nav-link px-2 text-white">Features</a></li>
            <li><a href="#" class="nav-link px-2 text-white">Pricing</a></li>
            <li><a href="#" class="nav-link px-2 text-white">FAQs</a></li>
            <li><a href="#" class="nav-link px-2 text-white">About</a></li>
          </ul>

          <form class="col-12 col-lg-auto mb-3 mb-lg-0 me-lg-3" role="search">
            <input type="search" class="form-control form-control-dark text-bg-dark" placeholder="Search..." aria-label="Search">
          </form>

          <div class="text-end">
            <button type="button" class="btn btn-outline-light me-2">Login</button>
            <button type="button" class="btn btn-warning">Sign-up</button>
          </div>
        </div>
      </div>
    </header>

    <div class="row min-vh-100">
      <div class="p-2 text-bg-dark col-2">
        <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-white text-decoration-none">
          <svg class="bi pe-none me-2" width="40" height="32"><use xlink:href="#bootstrap"></use></svg>
          <span class="fs-4">Sidebar</span>
        </a>
        <hr>
        <ul class="nav nav-pills flex-column mb-auto">
          <li class="nav-item">
            <a href="#" class="nav-link active" aria-current="page">
              <svg class="bi pe-none me-2" width="16" height="20"><use xlink:href="#home"></use></svg>
              Home
            </a>
          </li>
          <li><a href="#" class="nav-link text-white"><svg class="bi pe-none me-2" width="16" height="20"><use xlink:href="#speedometer2"></use></svg>Dashboard</a></li>
          <li><a href="#" class="nav-link text-white"><svg class="bi pe-none me-2" width="16" height="20"><use xlink:href="#table"></use></svg>Orders</a></li>
          <li><a href="#" class="nav-link text-white"><svg class="bi pe-none me-2" width="16" height="20"><use xlink:href="#grid"></use></svg>Products</a></li>
          <li><a href="#" class="nav-link text-white"><svg class="bi pe-none me-2" width="16" height="20"><use xlink:href="#people-circle"></use></svg>Customers</a></li>
        </ul>
        <hr>
      </div>

      <div class="col-9">
        <div class="container p-3 mt-4">
          <div class="container mt-5">
            <h2 class="mb-4">공지사항 입력</h2>
            <form class="pt-2" th:object="${notice}" th:action="@{/admin/notice}" method="post" enctype="multipart/form-data">
            	<input hidden type="text" value="admin" th:field="*{writer}"/>
            <!-- 카테고리 선택 -->
				<div class="mb-3">
				  <label class="form-label fw-semibold ">카테고리 선택</label>
				  <br/>
				  <div class="form-check form-check-inline">
				    <input class="form-check-input" type="radio" th:field="*{division}" value="BAKERY" required >
				    <label class="form-check-label " for="category1">빵집</label>
				  </div>
				  <div class="form-check form-check-inline">
				    <input class="form-check-input" type="radio" th:field="*{division}" value="RESTAURANT"  >
				    <label class="form-check-label " for="category2">레스토랑</label>
				  </div>
				  <div class="form-check form-check-inline">
				    <input class="form-check-input" type="radio" th:field="*{division}" value="ROOFTOP" >
				    <label class="form-check-label " for="category3">루프탑</label>
				  </div>
	              <span th:if="${#fields.hasErrors('division')}" th:errors="*{division}" class="error"></span>
				</div>
              <!-- 제목 입력 -->
              <div class="mb-3">
                <label for="title" class="form-label fw-semibold">제목</label>
                <input type="text" class="form-control" th:field="*{title}" placeholder="제목을 입력하세요" required>
                <span th:if="${#fields.hasErrors('title')}" th:errors="*{title}" class="error"></span>
                
              </div>

              <!-- 내용 입력 -->
              <div class="mb-3">
                <label for="content" class="form-label fw-semibold">내용</label>
                <textarea class="form-control" th:field="*{content}" rows="5" placeholder="내용을 입력하세요" required></textarea>
              </div>

              <!-- 파일 첨부 -->
              <div class="mb-3">
                <label for="file" class="form-label fw-semibold">파일 첨부</label>
                <input type="file" class="form-control" th:field="*{uploadImg}">
              </div>

              <!-- 등록 버튼 -->
              <button type="submit" class="btn btn-primary">등록</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.js"></script>
    <script>
    $(document).ready(function() {
        $('#content').summernote({
            height: 300, 
            placeholder: '내용을 입력하세요',
            disableDragAndDrop: false,  // 드래그앤드롭 활성화
            toolbar: [
                ['style', ['bold', 'italic', 'underline', 'clear']],
                ['font', ['strikethrough', 'superscript', 'subscript']],
                ['fontsize', ['fontsize']],
                ['color', ['color']],
                ['para', ['ul', 'ol', 'paragraph']],
                ['height', ['height']],
                ['insert', ['link', 'picture']]
            ],
            callbacks: {
                // 이미지 업로드 처리
                onImageUpload: function(files, el) {
                    var formData = new FormData();
                    formData.append('file', files[0]);

                    $.ajax({
                        url: '/upload/notice/img',  // 이미지 업로드 URL
                        method: 'POST',
                        data: formData,
                        contentType: false,
                        processData: false,
                        success: function(data) {
                   
                             var imageUrl = 'http://localhost:8080/img/upload/' + data.path; // 경로 연결
                             
                             console.log("imageUrl", imageUrl);

                             $('#content').summernote('insertImage', imageUrl);
                            
                        },
                        error: function(xhr, status, error) {
                            alert("이미지 업로드 실패: " + error);
                        }
                    });
                }
            }
        });
    });


    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  </body>
</html>
