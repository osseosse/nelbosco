<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
  <head th:replace="fragments/admin :: head"></head>
  <body>
  <header class="p-3 text-bg-dark" th:replace="fragments/admin :: header">
  </header>
  <div class="row min-vh-100">
  <div class="p-2 text-bg-dark col-2"  th:replace="fragments/admin :: sidebar" ></div>
        <div class=" col-9 container p-3 mt-4">
          <div class="container mt-5">
            <h2 class="mb-4">공지사항 입력</h2>
            <form class="pt-2" th:object="${notice}" th:action="@{/admin/notice}" method="post" enctype="multipart/form-data">
            	<input hidden type="text" value="admin" th:field="*{writer}"/>
            <!-- 카테고리 선택 -->
				<div class="mb-3">
				  <label class="form-label fw-semibold ">카테고리 선택</label>
				  <br/>
				  <div class="form-check form-check-inline">
				    <input class="form-check-input" type="radio" th:field="*{division}" value="BAKERY" required >
				    <label class="form-check-label " for="category1">빵집</label>
				  </div>
				  <div class="form-check form-check-inline">
				    <input class="form-check-input" type="radio" th:field="*{division}" value="RESTAURANT"  >
				    <label class="form-check-label " for="category2">레스토랑</label>
				  </div>
				  <div class="form-check form-check-inline">
				    <input class="form-check-input" type="radio" th:field="*{division}" value="ROOFTOP" >
				    <label class="form-check-label " for="category3">루프탑</label>
				  </div>
	              <span th:if="${#fields.hasErrors('division')}" th:errors="*{division}" class="error"></span>
				</div>
              <!-- 제목 입력 -->
              <div class="mb-3">
                <label for="title" class="form-label fw-semibold">제목</label>
                <input type="text" class="form-control" th:field="*{title}" placeholder="제목을 입력하세요" required>
                <span th:if="${#fields.hasErrors('title')}" th:errors="*{title}" class="error"></span>
                
              </div>

              <!-- 내용 입력 -->
              <div class="mb-3">
                <label for="content" class="form-label fw-semibold">내용</label>
                <textarea class="form-control" th:field="*{content}" rows="5" placeholder="내용을 입력하세요" required></textarea>
              </div>

              <!-- 파일 첨부 
              <div class="mb-3">
                <label for="file" class="form-label fw-semibold">파일 첨부</label>
                <input type="file" class="form-control" th:field="*{uploadImg}">
              </div>
				-->
              <!-- 등록 버튼 -->
              <button type="submit" class="btn btn-primary">등록</button>
            </form>
          </div>
        </div>
      </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.js"></script>
    <script>
    $(document).ready(function() {
        $('#content').summernote({
            height: 300, 
            placeholder: '내용을 입력하세요',
            disableDragAndDrop: false,  // 드래그앤드롭 활성화
            toolbar: [
                ['style', ['bold', 'italic', 'underline', 'clear']],
                ['font', ['strikethrough', 'superscript', 'subscript']],
                ['fontsize', ['fontsize']],
                ['color', ['color']],
                ['para', ['ul', 'ol', 'paragraph']],
                ['height', ['height']],
                ['insert', ['link', 'picture']]
            ],
            callbacks: {
                // 이미지 업로드 처리
                onImageUpload: function(files, el) {
                    var formData = new FormData();
                    formData.append('file', files[0]);
					console.log(formData);
                    $.ajax({
                        url: '/admin/summer/insertImg',  // 이미지 업로드 URL
                        method: 'POST',
                        data: formData,
                        contentType: false,
                        processData: false,
                        success: function(data) {
                   
//                             var imageUrl = 'https://nelbosco.co.kr/static/img/upload/' + data.path; // 경로 연결
                             var imageUrl = 'http://localhost:8080/static/img/upload/' + data.path; // 경로 연결
                             
                             console.log("imageUrl", imageUrl);

                             $('#content').summernote('insertImage', imageUrl);
                            
                        },
                        error: function(xhr, status, error) {
                        	console.log(status, error);
                            alert("이미지 업로드 실패: " + error);
                        }
                    });
                }
            }
        });
    });


    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  </body>
</html>
